const server="https://killerddd.pl/picture_categories/";let src,checked,hidden,section=document.querySelector("section"),aside=document.querySelector("aside"),asideMenuItems=aside.querySelectorAll("li:not(.head)"),imagesList=document.querySelectorAll(".images-list div.category");function toggleActivity(e){"0"==e.dataset.active?e.dataset.active="1":e.dataset.active="0",e.classList.toggle("active")}function changeCustomOptions(e,t){e.checked?document.getElementById(t).hidden=!1:document.getElementById(t).hidden=!0}function toggleEditionForm(e){e.parentElement.parentElement.classList.toggle("edition-active")}function showCategoryInfo(e,t,n){fetch(server+"api_backend.php?id="+e+"&shop="+n+"&name="+t,{method:"GET"}).then(function(e){return e.json()}).then(e=>{generateForm(e.name,e.id,e.image,e.shop,e.custom_image)})}function generateForm(e,t,n,a,i){1==i?(checked="checked",hidden="",src=""!=n&&null!=n?`images/${a}/${n}`:"assets/images/no_image.png"):(checked="",hidden="hidden",src=""!=n&&null!=n?`images/${a}/${n}`:"assets/images/no_image.png");var o=document.createElement("div");o.classList.add("form-wrapper"),o.innerHTML=`\n                        <div class='category-form'  action='' method='post' enctype='multipart/form-data'>\n                            <fieldset style="margin-bottom: 0; padding-bottom: 0;">\n                                <div class="options checkbox-wrapper">\n                                        <span class="label">Obrazek w≈Çasny:</span>\n                                    <div class="checkbox-wrapper">\n                                        <input type="checkbox" name="custom_image" onclick="changeCustomOptions(this, 'options_${t}')" ${checked}>\n                                    </div>\n                                </div>\n                                <div class="options img-option" id="options_${t}" ${hidden}>\n                                        <span class="label">Obrazek:</span>\n                                    <div class="image-upload">\n                                        <label for="file-input-${t}">\n                                           <img class="upload-img_${t}" style="width: 200px" src="${src}"/>\n                                        </label>\n\n                                        <input id="file-input-${t}" name="image" type="file" oninput="updateImg(this, '${t}')"/>\n                                    </div>\n                                </div>\n                                <div class="options">\n                                    <input type="hidden" name="category_id" value="${t}">\n                                    <button class="button" type="submit" onclick="saveCategoryInfo('${t}','${e}','${a}');showSuccessAlert()" name="category_save" value="1" >\n                                        Zapisz\n                                    </button>\n                                </div>\n                            </fieldset>\n                            </div>\n            `,null==document.querySelector(`[data-element-id='${t}'] .form-wrapper`)?document.querySelector(`[data-element-id='${t}']`).insertBefore(o,document.querySelector(`[data-element-id='${t}'] .cat-name`).nextSibling):document.querySelector(`[data-element-id='${t}'] .form-wrapper`).outerHTML=o.outerHTML}function updateImg(e,t){e.parentElement.querySelector(".upload-img_"+t).src=URL.createObjectURL(e.files.item(0))}function saveCategoryInfo(e,t,n){let a=document.querySelector(`[data-element-id="${e}"] .category-form`),i=a.querySelector('input[name="custom_image"]').checked;var o=a.querySelector('input[type="file"]'),s=new FormData;s.append("category_save",1),s.append("custom_image",i),s.append("category_id",e),s.append("name",t),s.append("shop",n),s.append("image",o.files[0]),fetch(server+"api_backend.php",{method:"POST",body:s}).then(function(e){return e.json()}).then(e=>{generateForm(e.name,e.id,e.image,e.shop,e.custom_image)})}function saveConfigInfo(e){var t=document.querySelector("section.wrapper .config");let n=t.querySelector(".mwidth").value,a=t.querySelector(".twidth").value,i=t.querySelector(".dwidth").value,o=t.querySelector(".activity-button").dataset.active;var s=new FormData;s.append("setting_save",1),s.append("mobile_width",n),s.append("tablet_width",a),s.append("desktop_width",i),s.append("activity",o),s.append("shop",e),fetch(server+"api_backend.php",{method:"POST",body:s}).then(function(e){return e.json()})}function showSuccessAlert(){document.querySelector(".settings-changed").style.opacity="1",setTimeout(function(){document.querySelector(".settings-changed").style.opacity="0"},5e3)}function setCategoriesFuncionality(){imagesList.forEach(e=>{if(showCategoryInfo(e.dataset.elementId,e.dataset.elementName,e.dataset.elementShop),null!=e.querySelector(":scope > .subcategories .category")){var t=document.createElement("button");t.classList.add("toggle-children"),t.innerHTML="<img src='assets/images/caret-down-solid.svg'>",e.prepend(t),t.addEventListener("click",()=>{e.classList.toggle("childrens-active")})}})}function setAsideItemsFuncionality(){asideMenuItems.forEach(e=>{e.addEventListener("click",()=>{asideMenuItems.forEach(e=>{e.style.color="inherit"}),e.style.color="#65bbff",section.style.display="block",section.querySelectorAll(":scope > div").forEach(e=>{e.style.display="none"}),section.querySelector(`.${e.className}`).style.display="block"})})}setCategoriesFuncionality(),setAsideItemsFuncionality();